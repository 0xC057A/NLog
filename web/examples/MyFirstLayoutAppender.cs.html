<pre xml:space='preserve'><span class='csharp'><span class='k'>using</span> System;
<span class='k'>using</span> System.Text;

<span class='k'>using</span> NLog;
<span class='k'>using</span> NLog.LayoutAppenders;

<span class='k'>namespace</span> MyNamespace
{
    [LayoutAppender(<span class='s'>&quot;hour&quot;</span>)]
    <span class='k'>public</span> <span class='k'>sealed</span> <span class='k'>class</span> HourLayoutAppender: LayoutAppender
    {
        <span class='k'>private</span> <span class='k'>bool</span> _showMinutes = <span class='k'>false</span>;
        
        <span class='c'>// this is an example of a configurable parameter</span>
        <span class='k'>public</span> <span class='k'>bool</span> ShowMinutes
        {
            get { <span class='k'>return</span> _showMinutes; }
            set { _showMinutes = value; }
            
        }
        <span class='k'>protected</span> <span class='k'>override</span> <span class='k'>int</span> GetEstimatedBufferSize(LogEventInfo ev)
        {
            <span class='c'>// since hour is expressed by 2 digits we need at most 2-character</span>
            <span class='c'>// buffer for it</span>
            <span class='k'>return</span> 2;
        }

        <span class='k'>protected</span> <span class='k'>override</span> <span class='k'>void</span> Append(StringBuilder builder, LogEventInfo ev)
        {
            <span class='c'>// get current hour or minute, convert it to string, apply padding</span>
            <span class='c'>// and append to the specified StringBuilder</span>
            <span class='k'>if</span> (ShowMinutes)
            {
                builder.Append(ApplyPadding(DateTime.Now.Minute.ToString()));
            }
            <span class='k'>else</span>
            {
                builder.Append(ApplyPadding(DateTime.Now.Hour.ToString()));
            }
        }
    }
}
</span>
</pre>