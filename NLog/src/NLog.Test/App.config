<?xml version="1.0" encoding="windows-1250" ?>
<configuration>
    <configSections>
        <section name="nlog" type="NLog.Config.ConfigSectionHandler, NLog" />
    </configSections>
    <nlog autoReload="true" internalLogToConsole="true">
        <variable name="jitcat" value=".NET CLR Jit" />
        <variable name="pc1" value="${performancecounter:category=${jitcat}:counter=# of IL Bytes Jitted}" />
        
        <targets>
            <target name="network" type="Network" address="udp://fw.home.lan:5000" newline="true" />
            <target name="console" type="Console" layout="${pc1}|${machinename}|${longdate}|${ndc:separator= -> :bottomframes=1}|${mdc:item=username}|${message}" />
            <target name="exceptions" type="Console" layout="EXCEPTION ${exception:format=method:padding=-35}x" />

            <target name="logproc" type="MethodCall" className="Test, NLog.Test" methodName="LogProc">
                <parameter type="System.String" layout="${message}" />
            </target>
            
            <target name="viewer" type="NLogViewer" address="udp://localhost:4000" includesourceinfo="true" includecallsite="true" includemdc="true" includendc="true">
                <parameter name="exc" layout="abc" />
            </target>
            
            <target name="database" type="Database">

                <dbprovider>mssql</dbprovider>

                <!-- database connection parameters -->
                <!-- alternatively you could provide a single 'connectionstring' parameter -->
                
                <dbhost>.</dbhost> 
                <dbdatabase>NLogDatabase</dbdatabase>
                <dbusername>nloguser</dbusername>
                <dbpassword>nlogpassword</dbpassword>
                
                <commandText>
                    insert into LogTable(time_stamp,level,logger,message) values(@time_stamp, @level, @logger, @message);
                </commandText>

                <parameter name="@time_stamp" layout="${date}" />
                <parameter name="@level" layout="${level}" />
                <parameter name="@logger" layout="${logger}" />
                <parameter name="@message" layout="${message}" />
            </target>
        </targets>

        <rules>
            <logger name="ExceptionLogger" appendTo="exceptions" final="true" />
            <logger name="*" minlevel="Debug" appendTo="console" />
        </rules>
    </nlog>
</configuration>

